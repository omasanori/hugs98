# @configure_input@
# Makefile for the Hugs 98 User's Guide
# (this should be a POSIX 1003.2-1992 Makefile)

INSTALL		= ../../install-sh
CP		= @CP@
RM		= @RM@
DOCBOOK2HTML	= @DOCBOOK2HTML@
DOCBOOK2DVI	= @DOCBOOK2DVI@
DOCBOOK2PDF	= @DOCBOOK2PDF@
DOCBOOK2PS	= @DOCBOOK2PS@

prefix		= @prefix@
exec_prefix	= @exec_prefix@
libdir		= @libdir@
datadir		= @datadir@
hugsdir		= @hugsdir@

SGMLDocWays	= html

ROOT		= users_guide
PARTS		= $(ROOT).sgml faq.sgml haskell98.sgml hugs_ghc.sgml \
		  hugs_only.sgml introduction.sgml license.sgml \
		  miscellaneous.sgml options.sgml using_hugs.sgml
CSS_FILE	= hugs-ug.css
DSL_FILE	= hugs-ug.dsl

# Don't use $(ROOT)/index.html, because depending on $(DOCBOOK2HTML) it
# could be $(ROOT)/$(ROOT).html instead.
HTML		= $(ROOT)/license.html

%.sgml: %.xml
	sed -f xml2sgml.sed $*.xml >$@

all: $(SGMLDocWays)

install: $(SGMLDocWays)
	if test -f $(HTML); \
	then	$(INSTALL) -d $(DESTDIR)$(hugsdir)/docs/users_guide; \
		$(CP) users_guide/*.html users_guide/$(CSS_FILE) $(DESTDIR)$(hugsdir)/docs/users_guide; \
	fi
	for ext in dvi pdf ps;\
	do	if test -f $(ROOT).$$ext;\
		then	$(CP) $(ROOT)$$ext $(DESTDIR)$(hugsdir)/docs;\
		fi;\
	done

clean:
	$(RM) $(PARTS)

distclean: clean
	$(RM) $(ROOT).dvi $(ROOT).ps $(ROOT).pdf
	$(RM) -r $(ROOT)
	$(RM) Makefile

veryclean: distclean

html: $(HTML)

dvi: $(ROOT).dvi

ps: $(ROOT).ps

pdf: $(ROOT).pdf

$(HTML): $(PARTS) $(DSL_FILE) $(CSS_FILE)
	$(RM) -r $(ROOT)
	mkdir $(ROOT)
	$(CP) $(CSS_FILE) $(ROOT)
	test -z '$(DOCBOOK2HTML)' || \
	  $(DOCBOOK2HTML) --dsl $(DSL_FILE) $(ROOT).sgml

$(ROOT).dvi: $(PARTS)
	test -z '$(DOCBOOK2DVI)' || $(DOCBOOK2DVI) $(ROOT).sgml

$(ROOT).ps: $(PARTS)
	test -z '$(DOCBOOK2PS)' || $(DOCBOOK2PS) $(ROOT).sgml

$(ROOT).pdf: $(PARTS)
	test -z '$(DOCBOOK2PDF)' || $(DOCBOOK2PDF) $(ROOT).sgml
